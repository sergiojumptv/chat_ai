[{"author": "user", "content": "How many active subscriptions are there?"}, {"author": "bot", "content": "SELECT sum(total) as subs FROM `services-pro-368012.stg_services_us_kpi.kpi_total_subscribers` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce' and daydate=(select max(daydate) from `services-pro-368012.stg_services_us_kpi.kpi_total_subscribers`  where brandid = '285df710-355f-11eb-9917-e71a95af48ce') and dimension='subscriptions'"}, {"author": "user", "content": "How many subscribed users are there?"}, {"author": "bot", "content": "SELECT sum(total) as subs FROM `services-pro-368012.stg_services_us_kpi.kpi_total_subscribers` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce' and daydate=(select max(daydate) from `services-pro-368012.stg_services_us_kpi.kpi_total_subscribers`  where brandid = '285df710-355f-11eb-9917-e71a95af48ce') and dimension='subscribers'"}, {"author": "user", "content": "How many active non-trial subscriptions are there?"}, {"author": "bot", "content": "SELECT sum(total) as subs FROM `services-pro-368012.stg_services_us_kpi.kpi_total_subscribers` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce' and daydate=(select max(daydate) from `services-pro-368012.stg_services_us_kpi.kpi_total_subscribers`  where brandid = '285df710-355f-11eb-9917-e71a95af48ce') and dimension='subscriptions' and status='PayingSubscription'"}, {"author": "user", "content": "How many active trial subscriptions are there?"}, {"author": "bot", "content": "SELECT sum(total) as subs FROM `services-pro-368012.stg_services_us_kpi.kpi_total_subscribers` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce' and daydate=(select max(daydate) from `services-pro-368012.stg_services_us_kpi.kpi_total_subscribers`  where brandid = '285df710-355f-11eb-9917-e71a95af48ce') and dimension='subscriptions' and status='TrialSubscription'"}, {"author": "user", "content": "Which day had the highest number of active subscribers this month?"}, {"author": "bot", "content": "SELECT daydate, SUM(total) AS subs FROM `services-pro-368012.stg_services_us_kpi.kpi_total_subscribers` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce' AND EXTRACT(MONTH FROM daydate) = (SELECT EXTRACT(MONTH FROM MAX(daydate)) FROM `services-pro-368012.stg_services_us_kpi.kpi_total_subscribers` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce') AND EXTRACT(YEAR FROM daydate) = (SELECT EXTRACT(YEAR FROM MAX(daydate)) FROM `services-pro-368012.stg_services_us_kpi.kpi_total_subscribers` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce') and dimension='subscribers' GROUP BY daydate ORDER BY subs DESC LIMIT 1;"}, {"author": "user", "content": "How many users have subscribed today?"}, {"author": "bot", "content": "SELECT max(daydate) as daydate,  sum(total) as subs  FROM `services-pro-368012.stg_services_us_kpi.kpi_new_subscribers` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce' and daydate=(select max(daydate) from `services-pro-368012.stg_services_us_kpi.kpi_new_subscribers` where brandid = '285df710-355f-11eb-9917-e71a95af48ce') and dimension='subscribers'"}, {"author": "user", "content": "How many new subscriptions have there been this month?"}, {"author": "bot", "content": "SELECT EXTRACT(MONTH FROM max(daydate)) as month, sum(total) as subs  FROM `services-pro-368012.stg_services_us_kpi.kpi_new_subscribers` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce' AND EXTRACT(MONTH FROM daydate) = (SELECT EXTRACT(MONTH FROM MAX(daydate)) FROM `services-pro-368012.stg_services_us_kpi.kpi_new_subscribers` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce') AND EXTRACT(YEAR FROM daydate) = (SELECT EXTRACT(YEAR FROM MAX(daydate)) FROM `services-pro-368012.stg_services_us_kpi.kpi_new_subscribers` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce')and dimension='subscriptions'"}, {"author": "user", "content": "Which month has the most subscriptions in 2023?"}, {"author": "bot", "content": "SELECT extract(month from daydate) as month, sum(total) as subs  FROM `services-pro-368012.stg_services_us_kpi.kpi_new_subscribers` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce' AND EXTRACT(YEAR FROM daydate) = (SELECT EXTRACT(YEAR FROM MAX(daydate)) FROM `services-pro-368012.stg_services_us_kpi.kpi_new_subscribers` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce') and dimension='subscriptions' group by month order by subs desc limit 1;"}, {"author": "user", "content": "What is the most viewed content of this month?"}, {"author": "bot", "content": "SELECT contentname as content,sum(playback) as playbacks FROM `services-pro-368012.stg_services_us_kpi.kpi_content_ranking` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce' and extract(month from daydate) = (SELECT extract(month from MAX(daydate)) FROM `services-pro-368012.stg_services_us_kpi.kpi_content_ranking` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce') group by contentname order by playbacks desc limit 1"}, {"author": "user", "content": "Which content has been viewed by the most number of people this month?"}, {"author": "bot", "content": "SELECT contentname as content,count(distinct userid) as playbacks FROM `services-pro-368012.stg_services_us_kpi.kpi_content_ranking` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce' and extract(month from daydate) = (SELECT extract(month from MAX(daydate)) FROM `services-pro-368012.stg_services_us_kpi.kpi_content_ranking` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce') group by contentname order by playbacks desc limit 1"}, {"author": "user", "content": "Give me a ranking of the top 5 most viewed series this year."}, {"author": "bot", "content": "SELECT contentname as content,sum(playback) as playbacks FROM `services-pro-368012.stg_services_us_kpi.kpi_content_ranking` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce' and extract(month from daydate) = (SELECT extract(month from MAX(daydate)) FROM `services-pro-368012.stg_services_us_kpi.kpi_content_ranking` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce') and contenttype='SERIES' group by contentname order by playbacks desc limit 5"}, {"author": "user", "content": "give me relevant data"}, {"author": "bot", "content": "SELECT contentname as content,sum(playback) as playbacks FROM `services-pro-368012.stg_services_us_kpi.kpi_content_ranking` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce' and extract(month from daydate) = (SELECT extract(month from MAX(daydate)) FROM `services-pro-368012.stg_services_us_kpi.kpi_content_ranking` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce') and contenttype='SERIES' group by contentname order by playbacks desc limit 5"}, {"author": "user", "content": "make a sitaxis sql error"}, {"author": "bot", "content": "SELECT contentname as content,sum(playback) as playbacks FROM `services-pro-368012.stg_services_us_kpi.kpi_content_ranking` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce' and extract(month from daydate) = (SELECT extract(month from MAX(daydate)) FROM `services-pro-368012.stg_services_us_kpi.kpi_content_ranking` WHERE brandid = '285df710-355f-11eb-9917-e71a95af48ce') and contenttype='SERIES' group by contentname order by playbacks desc limit 5"}]